{% extends "base.html" %}
{% load static %}

{% block title %}InÃ­cio{% endblock %}

{% block content %}
<div class="container my-5">

    <!-- Carousel de Banners -->
    {% if banners %}
    <style>
        .carousel-item {
            transition: transform 0.8s ease-in-out;
        }
        
        .carousel-item-next,
        .carousel-item-prev {
            display: block;
        }
    </style>
    <div id="bannersCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
        <div class="carousel-indicators">
            {% for banner in banners %}
            <button 
                type="button" 
                data-bs-target="#bannersCarousel" 
                data-bs-slide-to="{{ forloop.counter0 }}" 
                {% if forloop.first %}class="active" aria-current="true"{% endif %}
                aria-label="Slide {{ forloop.counter }}">
            </button>
            {% endfor %}
        </div>

        <div class="carousel-inner rounded-3 overflow-hidden">
            {% for banner in banners %}
            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                <img 
                    src="{{ banner.banner.url }}" 
                    class="d-block w-100" 
                    alt="{{ banner.name }}"
                    style="height: 400px; object-fit: cover;"
                >
            </div>
            {% endfor %}
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#bannersCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#bannersCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">PrÃ³ximo</span>
        </button>
    </div>
    {% endif %}

    {% if categories %}

        <!-- Header da home -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="fw-bold mb-0">Produtos em destaque</h4>

            <a 
                href="{% url 'market:all' %}" 
                class="btn btn-outline-primary btn-sm"
            >
                Ver todos
                <i class="bi bi-arrow-right ms-1"></i>
            </a>
        </div>

        <!-- Categorias -->
        {% for category in categories %}
            {% if category.products.all %}
                <section class="mb-5">
                    <h5 class="mb-3 fw-semibold">
                        {{ category.name }}
                    </h5>

                    {% include "scroll-product.html" with items=category.products.all %}
                </section>
            {% endif %}
        {% endfor %}

    {% else %}

        <!-- Estado vazio -->
        <div class="text-center py-5">
            <i class="bi bi-box-seam fs-1 text-muted"></i>
            <h4 class="mt-3">Sem produtos no momento</h4>
            <p class="text-muted">
                Volte mais tarde, em breve teremos novidades ðŸ˜‰
            </p>
        </div>

    {% endif %}

<script>
    document.querySelectorAll('.scroll-row').forEach(row => {
        row.addEventListener('wheel', (event) => {
            event.preventDefault();
            row.scrollBy({
                left: event.deltaY < 0 ? -120 : 120,
                behavior: 'smooth'
            });
        });
    });

    // Auto-play do carousel (opcional - troca a cada 5 segundos)
    var carousel = new bootstrap.Carousel(document.getElementById('bannersCarousel'), {
        interval: 5000,
        wrap: true
    });
</script>
</div>
{% endblock %}